<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="Add-in Express Blogs"
			description="Lists the latest Add-in Express Blog posts."
			title_url="http://www.add-in-express.com/"
			author="Add-in Express Ltd"
			author_email="http://www.add-in-express.com/"
			thumbnail="http://www.coalitionsoft.net/gadgetthumb.png" />
  <Content type="html">
    <![CDATA[
       <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <div>
        <ul id="news" style="list-style-type: none; margin: 0; padding: 0; font-size: small;"></ul>
    </div>
       <script type="text/javascript">
        
        function fetchData() {
            $('#info').html('Fetching Data');
            var params = {};
            params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.FEED;
            var url = "http://www.add-in-express.com/creating-addins-blog/feed/";
            gadgets.io.makeRequest(url, loadData, params);
        };

           function loadData(obj) {
            var items = obj.data.Entry;
            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                $("#news").append('<li class="list-group-item"><a href="' + item.Link + '" target="_blank" style="text-decoration: none;">' + item.Title + '</a></li><hr/>');
            }
            $('#info').remove();
        };
        gadgets.util.registerOnLoadHandler(fetchData);
    </script>
  ]]>
  </Content>
</Module>
